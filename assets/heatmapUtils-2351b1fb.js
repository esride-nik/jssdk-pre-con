import{bL as C,bM as b,bN as E,bO as F,bP as G}from"./index-a1cac181.js";const g=2.4;function U(t){return C(t*g)}function V(t){return b(t)/g}function L(t,o,r,a){let{color:u,ratio:c}=o,{color:f,ratio:n}=r;n===c&&(n===1?c-=1e-6:n+=1e-6);const e=G((a-c)/(n-c),0,1);E(t,u.toArray(),f.toArray(),e)}function Y(t){const r=new Uint8ClampedArray(2048);if(t=t.filter(({ratio:n})=>n>=0&&n<=1).sort((n,e)=>n.ratio-e.ratio).map(({color:n,ratio:e})=>({color:n,ratio:Math.max(e,.001)})),t.length<1)return r;let a=t[0],u=t[0],c=1;const f=F();for(let n=0;n<512;n++){const e=(n+.5)/512;for(;e>u.ratio&&c<t.length;)a=u,u=t[c++];L(f,a,u,e),r.set(f,4*n)}return r}function _(t,o,r,a){const{radius:u,fieldOffset:c,field:f}=o,n=Math.round(b(u)),e=new Float64Array(r*a);let s,m=Number.NEGATIVE_INFINITY;const A=q(f,c),M=new Set;for(const p of t){const l=p.getCursor();for(;l.next();){const x=l.getObjectId();if(M.has(x))continue;M.add(x);const i=l.readLegacyPointGeometry(),d=128;if(i.x<-d||i.x>=r+d||i.y<-d||i.y>a+d)continue;const I=+A(l),N=Math.max(0,Math.round(i.x)-n),w=Math.max(0,Math.round(i.y)-n),O=Math.min(a,Math.round(i.y)+n),P=Math.min(r,Math.round(i.x)+n);for(let h=w;h<O;h++)for(let y=N;y<P;y++){const $=h*r+y,j=T(i.x-y,i.y-h,n);s=e[$]+=j*I,s>m&&(m=s)}}}return{matrix:e.buffer,max:m}}function T(t,o,r){const a=Math.sqrt(t**2+o**2)/r;return a>1?0:3/(Math.PI*r**2)*(1-a**2)**2}function k(t,o){return typeof t=="function"?t:t?typeof o=="string"?r=>-1*+r[t]:r=>+r[t]+o:()=>1}function q(t,o){return t!=null?typeof o=="string"?r=>-1*+r.readAttribute(t):r=>+r.readAttribute(t)+o:r=>1}export{g as a,V as c,U as i,T as m,_ as s,Y as u,k as y};
